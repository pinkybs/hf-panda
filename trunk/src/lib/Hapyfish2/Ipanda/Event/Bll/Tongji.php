<?php
/**
 * bujisky.li
 * bujisky.li@hapyfish.com
 * */
class Hapyfish2_Ipanda_Event_Bll_Tongji
{
	
	public static function Tongji()
	{
		$db = array();
		for($i=0;$i<DATABASE_NODE_NUM;$i++){
			for($j=0;$j<=9;$j++){
				$db[$i][]= DATABASE_NODE_NUM*$j + $i;
			}
		}
		$list = array();
		$num = 0;
		$dal = Hapyfish2_Ipanda_Event_Dal_Tongji::getDefaultInstance();
		foreach($db as $k => $v){
			foreach($v as $k1 => $v1){
				$uidlist = $dal->getUid($v1);
				if(empty($list)){
					$list = $uidlist;
				}else{
					$list = array_merge($list, $uidlist);
				}
			}
	    }
		return $list;
	}

	public static function getUid()
	{
		$a = json_decode('["18800","19760","57040","63840","64240","68160","68720","73680","84080","128800","132560","136080","136320","22088","25448","32168","42568","69528","133688","133848","133928","134008","21056","37136","78816","79696","84096","84176","88176","97376","133056","135696","135936","136016","25944","29784","49624","66664","130104","133944","134104","10992","12112","50592","55312","61712","61952","66192","71152","72992","92512","114432","135792","135872","136032","18040","24680","60840","76360","136360","136440","31808","38048","61328","62448","63808","64448","65888","66368","68928","73408","81968","129808","132208","133648","133728","133808","134048","17976","42936","60456","67816","79016","83176","97176","135736","135896","12544","27824","27984","70224","78064","83424","83744","131824","133904","62552","64152","66792","69032","135832","135992","16881","54881","130001","135121","135201","135281","135361","135441","17929","22409","30409","43449","60569","67529","85849","128889","132409","133449","135929","136009","19537","19777","23537","26897","27217","31537","49697","55457","129777","136817","136977","137057","137137","26185","65625","72985","78745","82825","82905","103865","134585","135945","136105","16673","17073","27473","55073","66273","70433","71393","72593","134833","134913","134993","135073","135313","27081","35081","41481","52921","72121","72441","73321","79641","104761","115881","117081","133321","135081","135161","135241","135481","27969","44529","45649","58689","70209","107889","135969","136209","136289","136369","21497","25497","27497","50057","66617","75897","83657","136217","136777","136857","61185","61905","61985","62945","69185","72385","80545","80945","92785","104065","119185","135905","11433","15273","34233","59673","68633","80633","83353","84393","133353","134313","134793","134953","135273","135353","11682","52642","64882","65522","72962","78562","80242","125202","132402","135842","135922","136002","136082","20170","24730","27530","38570","47450","61530","62810","73610","76330","97450","129610","136090","136410","10418","61538","71218","73218","73938","76818","81138","81858","126978","131458","131538","131938","133618","133698","133938","134018","18346","26906","35946","52506","61146","63946","64906","64986","71146","135786","135866","135946","136026","12354","23154","25154","25394","72834","72994","73074","14202","35482","42762","63882","68522","68682","70682","72762","74202","77562","129402","135642","135722","136122","36450","65410","131970","136130","136290","136530","44298","53098","55738","64218","64778","80938","126458","128538","133658","133738","133818","133978","63986","74386","76146","85906","87826","135346","135986","10714","22474","28874","30554","68874","93274","110474","63283","67203","71203","81683","84403","87843","107283","127443","131363","134803","134963","135283","135363","23291","27211","46171","70171","70971","71851","88891","131291","131771","133931","135131","135211","135371","51859","62899","74419","76099","77059","82819","129219","131459","131779","135779","135859","135939","136019","136099","136179","136339","63067","63387","72907","76187","82907","123627","132427","133467","136587","136667","136907","136987","14675","35715","40195","66515","71235","109155","132115","135955","136115","27483","62843","68683","71483","73243","79963","134923","135003","135243","22531","25811","27571","72691","73251","90131","107331","135331","135491","135571","20299","62779","70619","71579","75179","111339","124059","132779","136219","136299","15267","36947","55587","60467","70467","74627","102947","124787","136467","136707","136787","136947","137027","137107","137187","21995","43195","61755","63435","67355","121515","125275","133595","133835","135115","135915","136075","136155","35764","64404","66404","69764","124164","133524","133764","133924","134004","134084","17852","22972","27612","60812","61132","81212","125772","130892","135692","135852","136012","136092","27860","28820","31780","33300","69700","70740","76340","93460","136100","136260","136420","136500","19148","26988","63068","68908","130508","133788","133948","39796","40676","47316","63556","65156","65876","66596","70676","86356","125636","134196","135716","135876","135956","24204","63964","69004","74764","76844","79324","80764","91484","116764","132444","133964","134044","134124","12692","15572","18212","22852","23492","29412","61812","67812","77172","79732","80132","89572","104612","135812","36380","63340","70300","71340","94700","129260","135980","136300","136380","136460","10628","60068","62388","71268","72068","72708","102468","132228","133588","133748","133908","133988","134068","39756","50796","67356","78956","83356","89356","105116","129596","135676","26965","49045","64245","65045","71365","78085","133605","135925","13773","15533","64813","71933","73933","106333","121773","130573","134893","135293","135373","13701","39301","60181","61301","61621","62181","65461","77301","88901","122821","135061","135141","135221","135381","135541","135621","15309","15469","30189","37549","39069","64349","70989","86269","90189","130989","132189","135389","135789","135949","136029","136109","18437","36837","42277","43877","60837","62357","65717","66197","71317","85237","114517","133157","136757","136837","136997","137077","17005","24845","28365","55165","61085","61325","71005","71965","80205","81885","117965","123085","125885","135885","135965","11653","25813","27733","37813","56853","66133","77813","103573","110613","120933","134853","135173","14861","18461","22941","71501","71981","79101","105821","123501","132381","134301","135341","135501","135581","43109","63989","91589","130069","135109","135909","135989","136149","136229","136309","58557","64477","79437","98877","126797","130557","131357","136637","137037","11926","26646","27126","61526","63686","79046","82566","92646","128646","135686","135846","135926","13694","57374","62014","63694","64494","68894","72574","76654","111294","10982","17062","31382","39462","71142","72502","81942","135702","135862","136022","136102","136182","63870","66270","72670","128830","29718","32438","65558","65718","65958","66438","68038","74438","85638","126918","133638","20926","35086","37566","39006","41166","59006","69086","71886","74926","77886","83006","122686","135806","10614","11254","36854","83974","95974","97894","133974","134054","134134","14542","25982","61102","64222","127022","135742","135822","135902","136062","11030","23270","66630","70070","71110","80710","94070","132870","134870","135990","136150","136230","136310","136390","136470","29838","29918","43598","49438","62798","65918","75438","79118","89918","129918","133758","10647","19847","19927","23447","29607","37847","67447","72007","78007","79927","132007","135047","136647","136727","136807","136887","137047","137127","25215","26735","63055","73935","85135","114895","135615","136015","18823","37783","41303","61543","62823","82503","82663","88743","90583","100343","134903","135223","29311","41951","62591","62831","68271","71231","71711","81231","82991","131631","134351","135071","135151","135231","135311","135391","135551","10679","15959","20359","34919","41639","55639","65559","66439","73879","73959","84359","106759","129159","135799","135879","136039","136199","10527","15967","25487","25567","39807","42207","52767","60767","64767","74847","84047","131327","136767","137167","24855","30695","61735","63255","72535","73175","80695","81415","95735","124695","129495","135895","135975","11583","13663","14463","37823","49743","61423","79823","109423","125743","127583","130383","131903","134783","134943","135023","135103","135183","135343","11271","48711","56231","63831","66151","68391","71191","77911","113031","135111","135351","135511","135591","12639","29119","36159","49839","54239","60959","64479","71199","76239","84559","89519","109199","116879","135759","135839","135919","135999","136079","136159"]');
		$dal = Hapyfish2_Ipanda_Dal_CompensationLog::getDefaultInstance();
		$date = '20120101';
		$isget = array();
		$noget = array();
		$getNum = 0;
		$total = count($a);
		foreach($a as $k => $v){
			$get = $dal->getOne($v, 1, $date);
			if($get){
				$isget[] = $get;
				$getNum +=1;
			}else{
				$noget[] = $v;
			}
		}
		return array('getnum'=>$getNum, 'total'=>$total, 'get'=>$isget, 'noget'=>$noget);
	}
}